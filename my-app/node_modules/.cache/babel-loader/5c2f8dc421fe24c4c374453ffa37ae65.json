{"ast":null,"code":"import _classCallCheck from \"/Users/eric/test/NSVT-FINAL/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/eric/test/NSVT-FINAL/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\n/*\r\n * Copyright (c) 2019 Rafael da Silva Rocha.\r\n * Copyright (c) 2014 Florian Markert\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining\r\n * a copy of this software and associated documentation files (the\r\n * \"Software\"), to deal in the Software without restriction, including\r\n * without limitation the rights to use, copy, modify, merge, publish,\r\n * distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to\r\n * the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n *\r\n */\n\n/**\r\n * @fileoverview Butterworth LPF. Based on the Butterworth LPF from Fili.js.\r\n * @see https://github.com/rochars/wavefile\r\n * @see https://github.com/markert/fili.js\r\n */\n\n/**\r\n * Butterworth LPF.\r\n */\nexport var ButterworthLPF = /*#__PURE__*/function () {\n  /**\r\n   * @param {number} order The order of the filter.\r\n   * @param {number} sampleRate The sample rate.\r\n   * @param {number} cutOff The cut off frequency.\r\n   */\n  function ButterworthLPF(order, sampleRate, cutOff) {\n    _classCallCheck(this, ButterworthLPF);\n\n    /** @type {!Array} */\n    var filters = [];\n\n    for (var i = 0; i < order; i++) {\n      filters.push(this.getCoeffs_({\n        Fs: sampleRate,\n        Fc: cutOff,\n        Q: 0.5 / Math.sin(Math.PI / (order * 2) * (i + 0.5))\n      }));\n    }\n\n    this.stages = [];\n\n    for (var _i = 0; _i < filters.length; _i++) {\n      this.stages[_i] = {\n        b0: filters[_i].b[0],\n        b1: filters[_i].b[1],\n        b2: filters[_i].b[2],\n        a1: filters[_i].a[0],\n        a2: filters[_i].a[1],\n        k: filters[_i].k,\n        z: [0, 0]\n      };\n    }\n  }\n  /**\r\n   * @param {number} sample A sample of a sequence.\r\n   * @return {number}\r\n   */\n\n\n  _createClass(ButterworthLPF, [{\n    key: \"filter\",\n    value: function filter(sample) {\n      /** @type {number} */\n      var out = sample;\n\n      for (var i = 0, len = this.stages.length; i < len; i++) {\n        out = this.runStage_(i, out);\n      }\n\n      return out;\n    }\n    /**\r\n     * @param {!Object} params The filter params.\r\n     * @return {!Object}\r\n     */\n\n  }, {\n    key: \"getCoeffs_\",\n    value: function getCoeffs_(params) {\n      /** @type {!Object} */\n      var coeffs = {};\n      coeffs.a = [];\n      coeffs.b = [];\n      /** @type {!Object} */\n\n      var p = this.preCalc_(params, coeffs);\n      coeffs.k = 1;\n      coeffs.b.push((1 - p.cw) / (2 * p.a0));\n      coeffs.b.push(2 * coeffs.b[0]);\n      coeffs.b.push(coeffs.b[0]);\n      return coeffs;\n    }\n    /**\r\n     * @param {!Object} params The filter params.\r\n     * @param {!Object} coeffs The coefficients template.\r\n     * @return {!Object}\r\n     */\n\n  }, {\n    key: \"preCalc_\",\n    value: function preCalc_(params, coeffs) {\n      /** @type {!Object} */\n      var pre = {};\n      /** @type {number} */\n\n      var w = 2 * Math.PI * params.Fc / params.Fs;\n      pre.alpha = Math.sin(w) / (2 * params.Q);\n      pre.cw = Math.cos(w);\n      pre.a0 = 1 + pre.alpha;\n      coeffs.a0 = pre.a0;\n      coeffs.a.push(-2 * pre.cw / pre.a0);\n      coeffs.k = 1;\n      coeffs.a.push((1 - pre.alpha) / pre.a0);\n      return pre;\n    }\n    /**\r\n     * @param {number} i The stage index.\r\n     * @param {number} sample The sample.\r\n     * @return {number}\r\n     */\n\n  }, {\n    key: \"runStage_\",\n    value: function runStage_(i, sample) {\n      /** @type {number} */\n      var temp = sample * this.stages[i].k - this.stages[i].a1 * this.stages[i].z[0] - this.stages[i].a2 * this.stages[i].z[1];\n      /** @type {number} */\n\n      var out = this.stages[i].b0 * temp + this.stages[i].b1 * this.stages[i].z[0] + this.stages[i].b2 * this.stages[i].z[1];\n      this.stages[i].z[1] = this.stages[i].z[0];\n      this.stages[i].z[0] = temp;\n      return out;\n    }\n    /**\r\n     * Reset the filter.\r\n     */\n\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      for (var i = 0; i < this.stages.length; i++) {\n        this.stages[i].z = [0, 0];\n      }\n    }\n  }]);\n\n  return ButterworthLPF;\n}();","map":{"version":3,"sources":["/Users/eric/test/NSVT-FINAL/my-app/node_modules/wavefile/lib/resampler/butterworth-lpf.js"],"names":["ButterworthLPF","order","sampleRate","cutOff","filters","i","push","getCoeffs_","Fs","Fc","Q","Math","sin","PI","stages","length","b0","b","b1","b2","a1","a","a2","k","z","sample","out","len","runStage_","params","coeffs","p","preCalc_","cw","a0","pre","w","alpha","cos","temp"],"mappings":"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","sourcesContent":["/*\r\n * Copyright (c) 2019 Rafael da Silva Rocha.\r\n * Copyright (c) 2014 Florian Markert\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining\r\n * a copy of this software and associated documentation files (the\r\n * \"Software\"), to deal in the Software without restriction, including\r\n * without limitation the rights to use, copy, modify, merge, publish,\r\n * distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to\r\n * the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n *\r\n */\r\n\r\n/**\r\n * @fileoverview Butterworth LPF. Based on the Butterworth LPF from Fili.js.\r\n * @see https://github.com/rochars/wavefile\r\n * @see https://github.com/markert/fili.js\r\n */\r\n\r\n/**\r\n * Butterworth LPF.\r\n */\r\nexport class ButterworthLPF {\r\n  \r\n  /**\r\n   * @param {number} order The order of the filter.\r\n   * @param {number} sampleRate The sample rate.\r\n   * @param {number} cutOff The cut off frequency.\r\n   */\r\n  constructor(order, sampleRate, cutOff) {\r\n    /** @type {!Array} */\r\n    let filters = [];\r\n    for (let i = 0; i < order; i++) {\r\n      filters.push(this.getCoeffs_({\r\n        Fs: sampleRate,\r\n        Fc: cutOff,\r\n        Q: 0.5 / (Math.sin((Math.PI / (order * 2)) * (i + 0.5)))\r\n      }));\r\n    }\r\n    this.stages = [];\r\n    for (let i = 0; i < filters.length; i++) {\r\n      this.stages[i] = {\r\n        b0 : filters[i].b[0],\r\n        b1 : filters[i].b[1],\r\n        b2 : filters[i].b[2],\r\n        a1 : filters[i].a[0],\r\n        a2 : filters[i].a[1],\r\n        k : filters[i].k,\r\n        z : [0, 0]\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {number} sample A sample of a sequence.\r\n   * @return {number}\r\n   */\r\n  filter(sample) {\r\n    /** @type {number} */\r\n    let out = sample;\r\n    for (let i = 0, len = this.stages.length; i < len; i++) {\r\n      out = this.runStage_(i, out);\r\n    }\r\n    return out;\r\n  }\r\n\r\n  /**\r\n   * @param {!Object} params The filter params.\r\n   * @return {!Object}\r\n   */\r\n  getCoeffs_(params) {\r\n    /** @type {!Object} */\r\n    let coeffs = {};\r\n    coeffs.a = [];\r\n    coeffs.b = [];\r\n    /** @type {!Object} */\r\n    let p = this.preCalc_(params, coeffs);\r\n    coeffs.k = 1;\r\n    coeffs.b.push((1 - p.cw) / (2 * p.a0));\r\n    coeffs.b.push(2 * coeffs.b[0]);\r\n    coeffs.b.push(coeffs.b[0]);\r\n    return coeffs;\r\n  }\r\n\r\n  /**\r\n   * @param {!Object} params The filter params.\r\n   * @param {!Object} coeffs The coefficients template.\r\n   * @return {!Object}\r\n   */\r\n  preCalc_(params, coeffs) {\r\n    /** @type {!Object} */\r\n    let pre = {};\r\n    /** @type {number} */\r\n    let w = 2 * Math.PI * params.Fc / params.Fs;\r\n    pre.alpha = Math.sin(w) / (2 * params.Q);\r\n    pre.cw = Math.cos(w);\r\n    pre.a0 = 1 + pre.alpha;\r\n    coeffs.a0 = pre.a0;\r\n    coeffs.a.push((-2 * pre.cw) / pre.a0);\r\n    coeffs.k = 1;\r\n    coeffs.a.push((1 - pre.alpha) / pre.a0);\r\n    return pre;\r\n  }\r\n  \r\n  /**\r\n   * @param {number} i The stage index.\r\n   * @param {number} sample The sample.\r\n   * @return {number}\r\n   */\r\n  runStage_(i, sample) {\r\n    /** @type {number} */\r\n    let temp = sample * this.stages[i].k - this.stages[i].a1 *\r\n      this.stages[i].z[0] - this.stages[i].a2 * this.stages[i].z[1];\r\n    /** @type {number} */\r\n    let out = this.stages[i].b0 * temp + this.stages[i].b1 *\r\n      this.stages[i].z[0] + this.stages[i].b2 * this.stages[i].z[1];\r\n    this.stages[i].z[1] = this.stages[i].z[0];\r\n    this.stages[i].z[0] = temp;\r\n    return out;\r\n  }\r\n\r\n  /**\r\n   * Reset the filter.\r\n   */\r\n  reset() {\r\n    for (let i = 0; i < this.stages.length; i++) {\r\n      this.stages[i].z = [0, 0];\r\n    }\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}