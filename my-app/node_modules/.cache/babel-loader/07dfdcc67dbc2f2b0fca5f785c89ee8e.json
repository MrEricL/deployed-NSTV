{"ast":null,"code":"import _classCallCheck from\"/Users/eric/test/herokutestcs/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/eric/test/herokutestcs/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/eric/test/herokutestcs/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/eric/test/herokutestcs/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/eric/test/herokutestcs/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{useRef,useEffect}from\"react\";import{convertToObject}from\"typescript\";import\"./Canvas.style.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Canvas=/*#__PURE__*/function(_React$Component){_inherits(Canvas,_React$Component);var _super=_createSuper(Canvas);function Canvas(props){var _this;_classCallCheck(this,Canvas);_this=_super.call(this,props);_this.state={ARR_NUM:0,MOUSE_POS:0,SCALE_FACTOR:1,DISPLAY_TRANSFORM:3,DISPLAY_ORIGINAL:1,checked1:true,checked2:true,checked3:true,SHIFT:0,vertical_scale:1};_this.getMax=_this.getMax.bind(_assertThisInitialized(_this));_this.display=_this.display.bind(_assertThisInitialized(_this));_this.wheelZoom=_this.wheelZoom.bind(_assertThisInitialized(_this));_this.mouseMove=_this.mouseMove.bind(_assertThisInitialized(_this));_this.displayTransform=_this.displayTransform.bind(_assertThisInitialized(_this));_this.displayOriginal=_this.displayOriginal.bind(_assertThisInitialized(_this));_this.displayLines=_this.displayLines.bind(_assertThisInitialized(_this));return _this;}//Takes in current position in array, array number, and data. Returns local max and mins within a window of size SCALE_FACTOR\n_createClass(Canvas,[{key:\"getMax\",value:function getMax(x,arraynum,data){var max=[x,0,0];for(var i=0;i<this.state.SCALE_FACTOR;i++){max[0]=x;if(data[arraynum][this.state.ARR_NUM][x]>max[1])max[1]=data[arraynum][this.state.ARR_NUM][x];else if(data[arraynum][this.state.ARR_NUM][x]<max[2])max[2]=data[arraynum][this.state.ARR_NUM][x];x++;}return max;}//Main display function, called on every zoom/ update. Should not be called when there is no data. \n},{key:\"display\",value:function display(){var canvas=this.refs.canvas;var c=canvas.getContext('2d');var data=this.props.data;var SCALE_FACTOR=this.state.SCALE_FACTOR;c.canvas.width=1920;c.moveTo(0,250);c.lineTo(1920,250);c.stroke();console.log(this.props.data);if(this.props.data.length==0||!this.props.data)return;for(var i=this.state.DISPLAY_ORIGINAL;i<this.state.DISPLAY_TRANSFORM;i++){var change=1;if(i==2)change=this.props.data[3];// console.log(change);\nvar x_coordinate=0;c.beginPath();var lines=0;var max=0;if(this.state.checked3){for(var x=Math.floor(this.state.SHIFT/Math.pow(10,this.state.ARR_NUM)/change);x<data[i][this.state.ARR_NUM].length;x++){if(lines>=1920)break;if(SCALE_FACTOR>1){var y=this.getMax(x,i,data);c.moveTo(Math.floor(x_coordinate*change),(0-y[2])*this.state.vertical_scale/data[0][0]+250);c.lineTo(Math.floor(x_coordinate*change),(0-y[1])*this.state.vertical_scale/data[0][0]+250);}else if(SCALE_FACTOR<0){c.moveTo(x_coordinate*Math.abs(SCALE_FACTOR)*change,250);c.lineTo(x_coordinate*Math.abs(SCALE_FACTOR)*change,0-data[i][this.state.ARR_NUM][x]*this.state.vertical_scale/data[0][0][0]+250);var y=[x,0,0];}else{c.moveTo(x_coordinate*change,250);c.lineTo(x_coordinate*change,0-data[i][this.state.ARR_NUM][x]*this.state.vertical_scale/data[0][0][0]+250);var y=[x,0,0];}lines++;x_coordinate+=1;x=y[0];max=x;}}else{for(var x=Math.floor(this.state.SHIFT/Math.pow(10,this.state.ARR_NUM)/change);x<data[i][this.state.ARR_NUM].length;x++){if(lines>=1920)break;if(SCALE_FACTOR>1){var y=this.getMax(x,i,data);c.fillRect(Math.floor(x_coordinate*change),(0-y[2])/data[0][0]+250,2,2);c.fillRect(Math.floor(x_coordinate*change),(0-y[1])/data[0][0]+250,2,2);}else if(SCALE_FACTOR<0){c.fillRect(x_coordinate*Math.abs(SCALE_FACTOR)*change,250,2,2);c.fillRect(x_coordinate*Math.abs(SCALE_FACTOR)*change,0-data[i][this.state.ARR_NUM][x]/data[0][0][0]+250,2,2);var y=[x,0,0];}else{c.fillRect(x_coordinate*change,250,2,2);c.fillRect(x_coordinate*change,0-data[i][this.state.ARR_NUM][x]/data[0][0][0]+250,2,2);var y=[x,0,0];}lines++;x_coordinate+=1;x=y[0];max=x;}}// console.log(max,\"***\");\nvar colors=['red','green','blue'];c.strokeStyle=colors[i];c.stroke();c.closePath();}// console.log(max);\n// console.log(lines);\n}},{key:\"wheelZoom\",value:function wheelZoom(event){if(Math.abs(event.deltaY/Math.abs(event.deltaY))!=1){return;}event.preventDefault();console.log(event);console.log(this.state.SHIFT);if(event.ctrlKey){this.state.SCALE_FACTOR=this.state.SCALE_FACTOR+=Math.floor(event.deltaY/Math.abs(event.deltaY));if(this.state.SCALE_FACTOR>19&&this.state.ARR_NUM<this.props.data.length){this.state.SCALE_FACTOR=2;this.state.ARR_NUM++;}else if(this.state.SCALE_FACTOR<=1&&this.state.ARR_NUM>=1){this.state.SCALE_FACTOR=19;this.state.ARR_NUM--;}console.log(this.state.SCALE_FACTOR,this.state.ARR_NUM);}else if(event.shiftKey){this.state.vertical_scale-=Math.floor(event.deltaY/Math.abs(event.deltaY));if(this.state.vertical_scale<=1)this.state.vertical_scale=1;console.log(this.state.vertical_scale);}else{this.state.SHIFT+=Math.floor(event.deltaY/Math.abs(event.deltaY))*500;if(this.state.SHIFT<=0){this.state.SHIFT=0;}}this.display();}//Stores current mouse position, useful for centering zoom on mouse, not yet implemented. \n},{key:\"mouseMove\",value:function mouseMove(event){var canvas=this.refs.canvas;var cRect=canvas.getBoundingClientRect();this.state.MOUSE_POS=Math.round(event.clientX-cRect.left);}},{key:\"displayLines\",value:function displayLines(event){this.setState({checked3:event.target.checked});}},{key:\"componentDidMount\",value:function componentDidMount(){var canvas=this.refs.canvas;var c=canvas.getContext(\"2d\");c.clearRect(0,0,canvas.width,canvas.height);canvas.addEventListener(\"wheel\",this.wheelZoom);canvas.addEventListener(\"mousemove\",this.mouseMove);// this.display();\nc.moveTo(0,250);c.lineTo(1920,250);c.stroke();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){console.log(\"update\");var canvas=this.refs.canvas;var c=canvas.getContext(\"2d\");c.clearRect(0,0,canvas.width,canvas.height);this.display();}},{key:\"displayTransform\",value:function displayTransform(event){if(event.target.checked){this.setState({DISPLAY_TRANSFORM:3});}else this.setState({DISPLAY_TRANSFORM:2});this.display();this.setState({checked1:event.target.checked});}},{key:\"displayOriginal\",value:function displayOriginal(event){if(event.target.checked)this.setState({DISPLAY_ORIGINAL:1});else this.setState({DISPLAY_ORIGINAL:2});this.display();this.setState({checked2:event.target.checked});}},{key:\"render\",value:function render(){console.log(\"rendered\");var styles={border:\"1px solid black\"};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"canvas\",{ref:\"canvas\",class:\"my_canvas\",width:1920,height:500,style:styles}),/*#__PURE__*/_jsx(\"form\",{onSubmit:this.handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{class:\"checkboxes\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:this.state.checked1,onChange:this.displayTransform}),\"Display Downsampled Waveform\"]}),/*#__PURE__*/_jsxs(\"div\",{class:\"checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:this.state.checked2,onChange:this.displayOriginal}),\"Display Original Waveform\"]}),/*#__PURE__*/_jsxs(\"div\",{class:\"checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:this.state.checked3,onChange:this.displayLines}),\"Draw Lines to Samples\"]})]})})]});}}]);return Canvas;}(React.Component);;export default Canvas;","map":{"version":3,"sources":["/Users/eric/test/herokutestcs/my-app/src/components/canvas/Canvas.js"],"names":["React","useRef","useEffect","convertToObject","Canvas","props","state","ARR_NUM","MOUSE_POS","SCALE_FACTOR","DISPLAY_TRANSFORM","DISPLAY_ORIGINAL","checked1","checked2","checked3","SHIFT","vertical_scale","getMax","bind","display","wheelZoom","mouseMove","displayTransform","displayOriginal","displayLines","x","arraynum","data","max","i","canvas","refs","c","getContext","width","moveTo","lineTo","stroke","console","log","length","change","x_coordinate","beginPath","lines","Math","floor","pow","y","abs","fillRect","colors","strokeStyle","closePath","event","deltaY","preventDefault","ctrlKey","shiftKey","cRect","getBoundingClientRect","round","clientX","left","setState","target","checked","clearRect","height","addEventListener","styles","border","handleSubmit","Component"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from \"react\";\r\nimport { convertToObject } from \"typescript\";\r\nimport \"./Canvas.style.css\";\r\n\r\nclass Canvas extends React.Component {\r\n\tconstructor(props){\r\n\t\tsuper(props);\r\n\t\tthis.state={\r\n\t\t\tARR_NUM : 0, \r\n\t\t\tMOUSE_POS: 0,\r\n\t\t\tSCALE_FACTOR: 1,\r\n\t\t\tDISPLAY_TRANSFORM: 3, \r\n\t\t\tDISPLAY_ORIGINAL: 1,\r\n\t\t\tchecked1:true,\r\n\t\t\tchecked2:true,\r\n\t\t\tchecked3: true,\r\n\t\t\tSHIFT: 0,\r\n\t\t\tvertical_scale:1,\r\n\t\t\t\r\n\t\t};\r\n\t\tthis.getMax=this.getMax.bind(this);\r\n\t\tthis.display=this.display.bind(this);\r\n\t\tthis.wheelZoom=this.wheelZoom.bind(this);\r\n\t\tthis.mouseMove=this.mouseMove.bind(this);\r\n\t\tthis.displayTransform= this.displayTransform.bind(this);\r\n\t\tthis.displayOriginal = this.displayOriginal.bind(this);\r\n\t\tthis.displayLines = this.displayLines.bind(this);\r\n\t}\r\n\r\n//Takes in current position in array, array number, and data. Returns local max and mins within a window of size SCALE_FACTOR\r\n\tgetMax(x,arraynum,data){\r\n\r\n\t\tvar max=[x,0,0] \r\n\t\tfor(var i=0; i<(this.state.SCALE_FACTOR); i++){\r\n\t\t\tmax[0]=x\r\n\t\t\tif(data[arraynum][this.state.ARR_NUM][x]>max[1])\r\n\t\t\t\tmax[1]=data[arraynum][this.state.ARR_NUM][x]\r\n\r\n\t\t\telse if(data[arraynum][this.state.ARR_NUM][x]<max[2])\r\n\t\t\t\tmax[2]=data[arraynum][this.state.ARR_NUM][x]\r\n\t\t\tx++\r\n\t\t}\r\n\t\treturn max\r\n\t}\r\n\r\n//Main display function, called on every zoom/ update. Should not be called when there is no data. \r\n\tdisplay(){\r\n\t\tvar canvas=this.refs.canvas;\r\n\t\tvar c=canvas.getContext('2d');\r\n\t\tvar data=this.props.data;\r\n\t\t\r\n\t\tvar SCALE_FACTOR= this.state.SCALE_FACTOR\r\n\t\tc.canvas.width=1920\r\n\t\tc.moveTo(0, 250)\r\n\t\tc.lineTo(1920, 250)\r\n\t\tc.stroke();\r\n\t\tconsole.log(this.props.data);\r\n\t\tif(this.props.data.length==0 || !this.props.data)\r\n\t\t\treturn;\r\n\t\tfor(var i = this.state.DISPLAY_ORIGINAL; i<this.state.DISPLAY_TRANSFORM; i++){\r\n\t\t\t\r\n\t\t\tvar change=1;\r\n\t\t\tif (i==2)\r\n\t\t\t\tchange= this.props.data[3]\r\n\t\t\t// console.log(change);\r\n\t\t\tvar x_coordinate=0;\r\n\t\t\tc.beginPath();\r\n\t\t\tvar lines=0;\r\n\t\t\tvar max=0;\r\n\t\t\tif (this.state.checked3){\r\n\t\t\t\tfor(var x = Math.floor(this.state.SHIFT/Math.pow(10,this.state.ARR_NUM)/change); x<data[i][this.state.ARR_NUM].length; x++){\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(lines>=1920) break;\r\n\r\n\t\t\t\t\tif(SCALE_FACTOR>1){\r\n\t\t\t\t\t\tvar y = this.getMax(x,i,data)\r\n\t\t\t\t\t\t\t\tc.moveTo(Math.floor(x_coordinate*change),((0-y[2])*this.state.vertical_scale/data[0][0]+250)) \r\n\t\t\t\t\t\t\t\tc.lineTo(Math.floor(x_coordinate*change), ((0-y[1])*this.state.vertical_scale/data[0][0]+250))\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (SCALE_FACTOR<0) {\r\n\t\t\t\t\t\tc.moveTo(x_coordinate*Math.abs(SCALE_FACTOR)*change, 250) \r\n\t\t\t\t\t\tc.lineTo(x_coordinate*Math.abs(SCALE_FACTOR)*change, ((0-data[i][this.state.ARR_NUM][x]*this.state.vertical_scale/data[0][0][0])+250))\r\n\t\t\t\t\t\tvar y=[x,0,0]\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tc.moveTo(x_coordinate*change, 250) \r\n\t\t\t\t\t\tc.lineTo(x_coordinate*change, ((0-data[i][this.state.ARR_NUM][x]*this.state.vertical_scale/data[0][0][0])+250))\r\n\t\t\t\t\t\tvar y=[x,0,0]\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlines++;\r\n\t\t\t\t\t\r\n\t\t\t\t\tx_coordinate+=1;\r\n\t\t\t\t\tx=y[0]\r\n\t\t\t\t\tmax=x;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tfor(var x = Math.floor(this.state.SHIFT/Math.pow(10,this.state.ARR_NUM)/change); x<data[i][this.state.ARR_NUM].length; x++){\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(lines>=1920) break;\r\n\r\n\t\t\t\t\tif(SCALE_FACTOR>1){\r\n\t\t\t\t\t\tvar y = this.getMax(x,i,data)\r\n\t\t\t\t\t\t\t\tc.fillRect(Math.floor(x_coordinate*change),(0-y[2])/data[0][0]+250,2,2) \r\n\t\t\t\t\t\t\t\tc.fillRect(Math.floor(x_coordinate*change), (0-y[1])/data[0][0]+250,2,2)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (SCALE_FACTOR<0) {\r\n\t\t\t\t\t\tc.fillRect(x_coordinate*Math.abs(SCALE_FACTOR)*change, 250,2,2) \r\n\t\t\t\t\t\tc.fillRect(x_coordinate*Math.abs(SCALE_FACTOR)*change, (0-data[i][this.state.ARR_NUM][x]/data[0][0][0])+250,2,2)\r\n\t\t\t\t\t\tvar y=[x,0,0]\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tc.fillRect(x_coordinate*change, 250,2,2) \r\n\t\t\t\t\t\tc.fillRect(x_coordinate*change, (0-data[i][this.state.ARR_NUM][x]/data[0][0][0])+250,2,2)\r\n\t\t\t\t\t\tvar y=[x,0,0]\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlines++;\r\n\t\t\t\t\t\r\n\t\t\t\t\tx_coordinate+=1;\r\n\t\t\t\t\tx=y[0]\r\n\t\t\t\t\tmax=x;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// console.log(max,\"***\");\r\n\t\t\tvar colors = ['red', 'green', 'blue']\r\n\t\t\tc.strokeStyle=colors[i];\r\n\t\t\tc.stroke();\r\n\t\t\tc.closePath();\r\n\t\t}\r\n\t\t\r\n\t\t// console.log(max);\r\n\t\t// console.log(lines);\r\n\t\t\t\r\n\t}\r\n\t\r\n\twheelZoom(event){\r\n\t\tif(Math.abs(event.deltaY/Math.abs(event.deltaY)) != 1){\r\n\t\t\treturn\r\n\t\t}\r\n\t\tevent.preventDefault();\r\n\t\tconsole.log(event);\r\n\t\tconsole.log(this.state.SHIFT);\r\n\t\t\r\n\t\tif(event.ctrlKey){\r\n\t\t\tthis.state.SCALE_FACTOR= this.state.SCALE_FACTOR+=Math.floor(event.deltaY/Math.abs(event.deltaY));\r\n\t\t\tif(this.state.SCALE_FACTOR > 19 && this.state.ARR_NUM<this.props.data.length){\r\n\t\t\t\tthis.state.SCALE_FACTOR=2;\r\n\t\t\t\tthis.state.ARR_NUM++;\r\n\t\t\t}\r\n\t\t\telse if(this.state.SCALE_FACTOR <= 1 && this.state.ARR_NUM>=1){\r\n\t\t\t\tthis.state.SCALE_FACTOR=19;\r\n\t\t\t\tthis.state.ARR_NUM--;\r\n\t\t\t}\r\n\t\t\tconsole.log(this.state.SCALE_FACTOR, this.state.ARR_NUM);\r\n\t\t}\r\n\t\t\r\n\t\telse if(event.shiftKey){\r\n\t\t\tthis.state.vertical_scale-=Math.floor(event.deltaY/Math.abs(event.deltaY));\r\n\t\t\tif(this.state.vertical_scale <=1)\r\n\t\t\t\tthis.state.vertical_scale=1;\r\n\t\t\tconsole.log(this.state.vertical_scale);\r\n\t\t}\r\n\t\t\r\n\t\telse{\r\n\t\t\tthis.state.SHIFT+=Math.floor(event.deltaY/Math.abs(event.deltaY))*500;\r\n\t\t\tif(this.state.SHIFT<=0){\r\n\t\t\t\tthis.state.SHIFT=0;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis.display();\r\n\t}\r\n\t\r\n\t//Stores current mouse position, useful for centering zoom on mouse, not yet implemented. \r\n\tmouseMove(event){\r\n\t\tvar canvas=this.refs.canvas;\r\n\t\tvar cRect = canvas.getBoundingClientRect();\r\n\t\tthis.state.MOUSE_POS = Math.round(event.clientX - cRect.left);\r\n\t}\r\n\t\r\n\tdisplayLines(event){\r\n\t\tthis.setState({checked3: event.target.checked})\r\n\t}\r\n\t\r\n\tcomponentDidMount(){\r\n\t\tconst canvas= this.refs.canvas;\r\n\t\tconst c= canvas.getContext(\"2d\")\r\n\t\t\r\n\t\tc.clearRect(0, 0, canvas.width, canvas.height);\r\n\t\tcanvas.addEventListener(\"wheel\", this.wheelZoom);\r\n\t\tcanvas.addEventListener(\"mousemove\", this.mouseMove);\r\n\t\t// this.display();\r\n\t\tc.moveTo(0, 250)\r\n\t\tc.lineTo(1920, 250)\r\n\t\tc.stroke()\r\n\t\t\r\n\t}\r\n\t\r\n   componentDidUpdate() {\r\n\t   console.log(\"update\");\r\n\t   const canvas= this.refs.canvas;\r\n\t\tconst c= canvas.getContext(\"2d\")\r\n\t\tc.clearRect(0, 0, canvas.width, canvas.height);\r\n\t\tthis.display();\r\n\t\t\r\n\t}\r\n\t\r\n\tdisplayTransform(event){\r\n\t\tif(event.target.checked){\r\n\t\t\tthis.setState({DISPLAY_TRANSFORM: 3})\r\n\t\t}\r\n\t\telse\r\n\t\t\tthis.setState({DISPLAY_TRANSFORM: 2})\r\n\t\tthis.display();\r\n\t\tthis.setState({checked1: event.target.checked})\r\n\t}\r\n\t\r\n\tdisplayOriginal(event){\r\n\t\tif(event.target.checked)\r\n\t\t\tthis.setState({DISPLAY_ORIGINAL: 1})\r\n\t\telse\r\n\t\t\tthis.setState({DISPLAY_ORIGINAL: 2})\r\n\t\tthis.display();\r\n\t\tthis.setState({checked2: event.target.checked})\r\n\t}\r\n\t\r\n  render(){\r\n\t  console.log(\"rendered\");\r\n\tconst styles={\r\n\t\tborder: \"1px solid black\"\r\n\t\t\r\n\t};\r\n\treturn (\r\n\t <div>\r\n\t\t<canvas ref=\"canvas\" class=\"my_canvas\" width={1920} height={500} style={styles}/>\r\n\t\t<form onSubmit={this.handleSubmit}> \r\n\t\t<div class=\"checkboxes\">\r\n\t\t<div class=\"checkbox\">\r\n          <input type=\"checkbox\" checked={this.state.checked1} onChange={this.displayTransform}/>\r\n\t\t\t{\"Display Downsampled Waveform\"}\r\n\t\t</div>\r\n\t\t<div class=\"checkbox\">\r\n\t\t\t <input type=\"checkbox\" checked={this.state.checked2} onChange={this.displayOriginal}/>\r\n\t\t\t{\"Display Original Waveform\"}\r\n\t\t</div>\r\n\t\t<div class=\"checkbox\">\r\n\t\t\t<input type=\"checkbox\" checked={this.state.checked3} onChange={this.displayLines}/>\r\n\t\t\t{\"Draw Lines to Samples\"}\r\n\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t\r\n\t</div>\r\n\r\n\t);\r\n  }\r\n};\r\n\r\nexport default Canvas;\r\n"]},"metadata":{},"sourceType":"module"}